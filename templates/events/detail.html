{% extends "base.html" %}
{% block content %}

<div class="rsvp-wrapper">

  <!-- Event Title -->
  <h2 class="rsvp-title">{{ event.title }}</h2>

  <!-- Event Details Card -->
  <div class="rsvp-card">
    <p><strong>Date & Time:</strong> {{ event.date_of_event }}</p>
    <p><strong>Description:</strong> {{ event.description }}</p>

    {% if event.address1 %}
    <p><strong>Location:</strong> 
      {{ event.address1 }}{% if event.address2 %}, {{ event.address2 }}{% endif %}, 
      {{ event.city }}, {{ event.state }} {{ event.postal_code }}
    </p>
    {% endif %}

    <p><strong>Event Status:</strong> {{ event.status }}</p>
  </div>

  <!-- RSVP Section -->
  <div class="rsvp-card">
    <h3>RSVP</h3>

    <form action="{{ url_for('event_bp.rsvp', event_id=event.event_id) }}" method="POST" class="rsvp-form">

      <label for="status">Your response:</label>
      <select name="status" id="status">
        <option value="yes" {% if user_rsvp and user_rsvp.status == 'yes' %}selected{% endif %}>Yes</option>
        <option value="no" {% if user_rsvp and user_rsvp.status == 'no' %}selected{% endif %}>No</option>
        <option value="maybe" {% if user_rsvp and user_rsvp.status == 'maybe' %}selected{% endif %}>Maybe</option>
      </select>

      <button type="submit" class="btn">Submit RSVP</button>
    </form>
    {% if submitted %}
<div class="flash flash-success rsvp-flash">
  <svg class="flash-icon" viewBox="0 0 20 20">
    <path fill="currentColor" d="M7.629 13.233l-3.39-3.39L2 12.082l5.629 
    5.63L18 7.342l-2.238-2.238z"/>
  </svg>
  Your RSVP has been updated!
</div>
{% endif %}
  </div>

  <!-- Attendee List -->
  <div class="rsvp-card">
    <h3>Attendees</h3>

    {% if rsvps %}
    <ul class="attendee-list">
      {% for r in rsvps %}
        <li>
          <span class="attendee-name">{{ r.name }}</span>
    
          <span class="attendee-status status-{{ r.status }}">
            
            {% if r.status == 'yes' %}
              <svg class="status-icon yes-icon" viewBox="0 0 20 20">
                <path fill="currentColor" d="M7.629 13.233l-3.39-3.39L2 12.082l5.629 5.63L18 7.342l-2.238-2.238z"/>
              </svg>
              Yes
    
            {% elif r.status == 'no' %}
              <svg class="status-icon no-icon" viewBox="0 0 20 20">
                <path fill="currentColor" d="M14.348 5.652l-1-1L10 8.002 6.652 4.652l-1 1L9.002 10l-3.35 3.348 1 1L10 12.002l3.348 3.348 1-1L11.002 10z"/>
              </svg>
              No
    
            {% else %}
              <svg class="status-icon maybe-icon" viewBox="0 0 20 20">
                <path fill="currentColor" d="M10 2C5.589 2 2 5.589 2 10s3.589 
                8 8 8 8-3.589 8-8-3.589-8-8-8zm1 13H9v-2h2v2zm1.071-5.071l-.829.828C10.88 
                11.44 10.5 12 10.5 13h-2c0-1.161.54-2.161 1.299-2.922l1.3-1.299A1.5 1.5 
                0 1 0 9.5 6.5h-2a3.5 3.5 0 1 1 5.571 2.429z"/>
              </svg>
              Maybe
    
            {% endif %}
          </span>
        </li>
      {% endfor %}
    </ul>
    {% else %}
      <p>No RSVPs yet. Be the first!</p>
    {% endif %}
  </div>

  <a href="{{ url_for('event_bp.list_events') }}" class="back-link">&larr; Back to Events</a>

</div>

{% endblock %}
